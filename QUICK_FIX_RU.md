# Быстрое исправление проблемы с OMR блок-тестов

## Проблема
При сканировании OMR листа блок-теста показывается больше вопросов (27-30) вместо правильного количества (25 по конфигурации студента).

**Причины:**
1. Python скрипт находит лишние круги на изображении (шум, элементы дизайна)
2. Вопросы не фильтруются по конфигурации студента (выбранные предметы)

## Решение

### Шаг 1: Перезапустите сервер
```bash
cd server
npm run dev
```

### Шаг 2: Обновите существующие варианты (выберите один из вариантов)

**Вариант А: Пересоздать варианты (РЕКОМЕНДУЕТСЯ)**
1. Откройте страницу блок-теста
2. Удалите старые варианты
3. Создайте новые варианты
4. Готово! Новые варианты будут работать правильно

**Вариант Б: Обновить скриптом**
```bash
cd server
npx ts-node src/scripts/updateBlockTestVariants.ts
```

### Шаг 3: Проверьте работу
1. Отсканируйте OMR лист с QR-кодом
2. Проверьте, что показывается правильное количество вопросов (25 вместо 30)
3. Проверьте логи сервера - должно быть:
   ```
   ✅ Вопросы содержат subjectId, фильтруем по конфигурации
   ✅ Jami 25 ta to'g'ri javob (filtered shuffled)
   ```

## Что было исправлено
- При создании вариантов теперь сохраняется `subjectId` для каждого вопроса
- При сканировании OMR вопросы фильтруются по конфигурации студента
- **Лишние круги, найденные Python скриптом, игнорируются**
- **Обрабатываются только первые N вопросов из QR-кода**
- Правильно вычисляется общее количество вопросов

## Если не работает
1. Убедитесь, что варианты пересозданы или обновлены скриптом
2. Проверьте логи сервера на наличие ошибок
3. Убедитесь, что у студента есть конфигурация (`StudentTestConfig`)

Подробная документация: `FIX_BLOCK_TEST_OMR.md`
