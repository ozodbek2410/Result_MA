# Reference DOCX Template

Этот шаблон используется для генерации Word-документов с заданными параметрами верстки.

## Параметры верстки

- **Шрифт:** Cambria, размер 11 (22 half-points)
- **Колонки:** 2 колонки с отступом 0.5 дюйма
- **Интервалы:** Межстрочный интервал 1 (240 twips), без отступов после параграфа
- **Поля:** Минимальные (Narrow) - 1.27 см (0.5 дюйма) со всех сторон

## Фоновое изображение

### Автоматическое добавление ✅

Фоновое изображение (`client/public/logo.png`) **автоматически добавляется** при каждом экспорте Word документа.

- **PDF:** Фон добавляется автоматически при генерации
- **Word:** Фон добавляется программно после Pandoc конвертации

**Прозрачность:** 50% (настраивается в `PandocDocxService.addWatermark()`)

### Как это работает

1. Pandoc генерирует базовый DOCX из Markdown
2. `PandocDocxService.addWatermark()` распаковывает DOCX (это ZIP архив)
3. Добавляет `logo.png` в `word/media/watermark.png`
4. Создает `header1.xml` с водяным знаком за текстом
5. Обновляет все XML связи
6. Запаковывает обратно в DOCX

**Никаких ручных настроек не требуется!**

## Пересоздание шаблона

Если нужно изменить параметры верстки:

1. Отредактируй `server/scripts/createReferenceDocx.ts`
2. Запусти: `npm run create-reference --workspace=server`
3. Новый `reference.docx` будет создан в `server/templates/`

## Использование

Шаблон автоматически используется при генерации Word-документов через `PandocDocxService.generateDocx()`.

