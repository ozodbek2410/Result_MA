# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Word Export (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)

## –°—Ç–∞—Ç—É—Å
‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω (–ø–æ—Ä—Ç 9999)  
‚úÖ Worker –∑–∞–ø—É—â–µ–Ω (BullMQ)  
‚úÖ LocalFileService –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω  
‚úÖ MongoDB –ø–æ–¥–∫–ª—é—á–µ–Ω

## –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. **–£–±—Ä–∞–Ω–∞ —Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ S3** - —Ç–µ–ø–µ—Ä—å —Ä–æ—É—Ç –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 503 –æ—à–∏–±–∫—É
2. **–î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ** - —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `server/exports/`
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback** - –µ—Å–ª–∏ S3 –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
4. **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–æ—É—Ç** - —Ñ–∞–π–ª—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ URL `http://localhost:9999/exports/...`

## –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –û—Ç–∫—Ä—ã—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
```bash
cd client
npm run dev
```

### 2. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–µ—Å—Ç–∞
1. –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É (teacher)
2. –û—Ç–∫—Ä—ã—Ç—å –ª—é–±–æ–π —Ç–µ—Å—Ç
3. –ù–∞–∂–∞—Ç—å "Chop etish" (Print)

### 3. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –≤ Word
1. –í—ã–±—Ä–∞—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
3. –ù–∞–∂–∞—Ç—å "Word yuklash"

### 4. –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç (–Ω–æ–≤—ã–π):**
1. –ü–æ—è–≤–∏—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "Export jarayoni boshlandi"
2. –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä –ø–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç—É—Å (0% ‚Üí 100%)
3. –ß–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ —Ñ–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞–µ—Ç—Å—è
4. –§–∞–π–ª –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ `server/exports/exports/{userId}/{jobId}-{timestamp}.docx`

**–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç (fallback):**
- –ï—Å–ª–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π
- –§–∞–π–ª —Å–∫–∞—á–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –±–µ–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä–∞

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

### –°–µ—Ä–≤–µ—Ä (Process 4)
```bash
# –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
‚úÖ Local file storage initialized: C:\Users\ozodb\Desktop\Result_MA\server\exports
‚úÖ [API] Job {jobId} queued for test {testId} ({count} students)
```

### Worker (Process 2)
```bash
# –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
‚úÖ [Worker 19780] Ready to process jobs
üîÑ [Worker 19780] Processing job {jobId} for test {testId}
üìä [Worker 19780] Students: {count}, Settings: {...}
‚úÖ [Worker 19780] Test loaded: {testName}
‚úÖ [Worker 19780] Loaded {count} variants
‚úÖ [Worker 19780] Test data prepared: {count} students
üìÑ [Worker 19780] Generating Word with Pandoc...
‚úÖ [Worker 19780] Word generated: {size} KB
‚úÖ [Worker 19780] Saved locally: http://localhost:9999/exports/...
‚úÖ [Worker 19780] Job {jobId} completed successfully
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
server/
‚îú‚îÄ‚îÄ exports/                           # –°–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ exports/
‚îÇ       ‚îî‚îÄ‚îÄ {userId}/
‚îÇ           ‚îî‚îÄ‚îÄ {jobId}-{timestamp}.docx
‚îî‚îÄ‚îÄ src/
    ‚îî‚îÄ‚îÄ services/
        ‚îî‚îÄ‚îÄ localFileService.ts        # –ù–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ü–æ—Ä—Ç 9999 –∑–∞–Ω—è—Ç
```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å
Get-NetTCPConnection -LocalPort 9999 | Select-Object -ExpandProperty OwningProcess

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
Stop-Process -Id {PID} -Force
```

### 2. Worker –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)
REDIS_ENABLED=false  # –í .env –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å false –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```

### 3. –§–∞–π–ª –Ω–µ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ `BASE_URL=http://localhost:9999` –≤ `.env`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–æ—É—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç: –æ—Ç–∫—Ä—ã—Ç—å `http://localhost:9999/exports/` –≤ –±—Ä–∞—É–∑–µ—Ä–µ

### 4. Pandoc –æ—à–∏–±–∫–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Pandoc —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
pandoc --version

# –ï—Å–ª–∏ –Ω–µ—Ç - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
# Windows: choco install pandoc
# Mac: brew install pandoc
# Linux: sudo apt install pandoc
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ `server/exports/`
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ñ–∞–π–ª—ã —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ñ–æ—Ä–º—É–ª—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ Word
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–µ—Ä–µ–º–µ—à–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
5. ‚è≥ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤ (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ LocalFileService)

## –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ S3 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ö–æ–≥–¥–∞ –±—É–¥–µ—à—å –≥–æ—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å S3:

```env
# –î–æ–±–∞–≤–∏—Ç—å –≤ server/.env
S3_BUCKET=resultma-exports
AWS_ACCESS_KEY=your_key
AWS_SECRET_KEY=your_secret
AWS_REGION=us-east-1
```

Worker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–Ω–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å S3 –≤–º–µ—Å—Ç–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
# –í Kiro: controlPwshProcess -> stop -> processId: 4

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å worker
# –í Kiro: controlPwshProcess -> stop -> processId: 2

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
cd server
npm run dev      # –í –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
npm run worker   # –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
```

---

**–î–∞—Ç–∞:** 2026-02-17  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
