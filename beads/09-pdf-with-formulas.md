# üéØ PDF Export —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ä–µ–Ω–¥–µ—Ä–æ–º —Ñ–æ—Ä–º—É–ª

## üìä –°–¢–ê–¢–£–°: ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

**–î–∞—Ç–∞:** 2026-02-15

---

## üéØ –û–ü–ò–°–ê–ù–ò–ï

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è PDF —Å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ–æ—Ä–º—É–ª–∞–º–∏ —á–µ—Ä–µ–∑ Playwright + KaTeX.

**–ü—Ä–æ–±–ª–µ–º–∞:** –§–æ—Ä–º—É–ª—ã –≤ PDF –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –∫–∞–∫ –º—É—Å–æ—Ä (LaTeX –∫–æ–¥ –≤–º–µ—Å—Ç–æ –∫—Ä–∞—Å–∏–≤—ã—Ö —Ñ–æ—Ä–º—É–ª).

**–†–µ—à–µ–Ω–∏–µ:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF —á–µ—Ä–µ–∑ Headless Chromium —Å —Ä–µ–Ω–¥–µ—Ä–æ–º —Ñ–æ—Ä–º—É–ª —á–µ—Ä–µ–∑ KaTeX.

---

## ‚úÖ –ß–¢–û –°–î–ï–õ–ê–ù–û

### 1. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Playwright** - Headless Chromium –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF
- **KaTeX** - –ë—ã—Å—Ç—Ä—ã–π —Ä–µ–Ω–¥–µ—Ä –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–æ—Ä–º—É–ª
- **–ü–æ—á–µ–º—É KaTeX, –∞ –Ω–µ MathJax:**
  - –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä (–Ω–µ –Ω—É–∂–Ω–æ –∂–¥–∞—Ç—å async)
  - –ë—ã—Å—Ç—Ä–µ–µ –≤ 10+ —Ä–∞–∑
  - –ú–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
  - –ü—Ä–æ—â–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### 2. –ù–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å `pdfGeneratorService.ts`

**–§—É–Ω–∫—Ü–∏–∏:**
- `generatePDF(testData)` - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç PDF –∏–∑ –¥–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞
- `generateHTML(testData)` - —Å–æ–∑–¥–∞–µ—Ç HTML —à–∞–±–ª–æ–Ω —Å KaTeX
- `renderMath(text)` - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç LaTeX —Ñ–æ—Ä–º—É–ª—ã –≤ —Ç–µ–∫—Å—Ç–µ
- `getBrowser()` - –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±—Ä–∞—É–∑–µ—Ä –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ñ–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–Ω–¥–µ—Ä–∞ —Ñ–æ—Ä–º—É–ª –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π PDF
- –¢–∞–π–º–∞—É—Ç 30 —Å–µ–∫ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏, 10 —Å–µ–∫ –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∞ —Ñ–æ—Ä–º—É–ª
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ inline `$...$` –∏ display `$$...$$` —Ñ–æ—Ä–º—É–ª

### 3. HTML —à–∞–±–ª–æ–Ω

**CSS –¥–ª—è –ø–µ—á–∞—Ç–∏:**
- A4 —Ñ–æ—Ä–º–∞—Ç
- 2 –∫–æ–ª–æ–Ω–∫–∏
- `page-break-inside: avoid` - –∑–∞–ø—Ä–µ—Ç —Ä–∞–∑—Ä—ã–≤–∞ –≤–æ–ø—Ä–æ—Å–∞
- Times New Roman 11pt
- –ü–æ–ª—è 15mm

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ç–µ—Å—Ç–µ
- –í–æ–ø—Ä–æ—Å—ã –≤ 2 –∫–æ–ª–æ–Ω–∫–∏
- –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω—É–º–µ—Ä–∞—Ü–∏—è

### 4. –û–±–Ω–æ–≤–ª–µ–Ω—ã endpoints

**`GET /tests/:id/export-pdf`:**
- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç TipTap JSON ‚Üí LaTeX
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç PDF —á–µ—Ä–µ–∑ Playwright
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∞–π–ª —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ñ–æ—Ä–º—É–ª–∞–º–∏

**`GET /block-tests/:id/export-pdf`:**
- –¢–æ –∂–µ —Å–∞–º–æ–µ –¥–ª—è –±–ª–æ–∫-—Ç–µ—Å—Ç–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–º–µ—à–∞–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

### 5. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

**–§—É–Ω–∫—Ü–∏—è `convertTiptapToLatex()`:**
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç LaTeX –∏–∑ TipTap JSON
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç marks (—Ñ–æ—Ä–º—É–ª—ã)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç `$...$` –¥–ª—è KaTeX

---

## üìÅ –§–ê–ô–õ–´

### –ù–æ–≤—ã–µ:
- `server/src/services/pdfGeneratorService.ts` - —Å–µ—Ä–≤–∏—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ:
- `server/src/routes/test.routes.ts` - –æ–±–Ω–æ–≤–ª–µ–Ω endpoint
- `server/src/routes/blockTest.routes.ts` - –æ–±–Ω–æ–≤–ª–µ–Ω endpoint
- `server/package.json` - –¥–æ–±–∞–≤–ª–µ–Ω—ã playwright, katex

---

## üöÄ –ö–ê–ö –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞:
```bash
cd server
npx playwright install chromium
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
1. –û—Ç–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç
2. –ù–∞–∂–∞—Ç—å "PDF yuklash"
3. –§–∞–π–ª —Å–∫–∞—á–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω–Ω—ã–º–∏ —Ñ–æ—Ä–º—É–ª–∞–º–∏

---

## üé® –û–°–û–ë–ï–ù–ù–û–°–¢–ò PDF

1. **–§–æ—Ä–º—É–ª—ã:**
   - –†–µ–Ω–¥–µ—Ä—è—Ç—Å—è —á–µ—Ä–µ–∑ KaTeX
   - –í—ã–≥–ª—è–¥—è—Ç —Ç–∞–∫ –∂–µ, –∫–∞–∫ –Ω–∞ —Å–∞–π—Ç–µ
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö LaTeX –∫–æ–º–∞–Ω–¥

2. **–§–æ—Ä–º–∞—Ç:**
   - A4, 2 –∫–æ–ª–æ–Ω–∫–∏
   - Times New Roman 11pt
   - –ü–æ–ª—è 15mm
   - –ó–∞–ø—Ä–µ—Ç —Ä–∞–∑—Ä—ã–≤–∞ –≤–æ–ø—Ä–æ—Å–∞ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏

3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
   - –ë—Ä–∞—É–∑–µ—Ä –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ~2-3 —Å–µ–∫ –Ω–∞ —Ç–µ—Å—Ç
   - –¢–∞–π–º–∞—É—Ç—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
   - –¢–∞–π–º–∞—É—Ç –∑–∞–≥—Ä—É–∑–∫–∏: 30 —Å–µ–∫
   - –¢–∞–π–º–∞—É—Ç —Ä–µ–Ω–¥–µ—Ä–∞: 10 —Å–µ–∫
   - Headless —Ä–µ–∂–∏–º
   - Sandbox –æ—Ç–∫–ª—é—á–µ–Ω –¥–ª—è Docker

---

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### –ü—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
   - –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–∞ –∏–∑ –ë–î
   - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è TipTap JSON ‚Üí LaTeX
   - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤

2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML:**
   - –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ KaTeX CSS/JS
   - –°–æ–∑–¥–∞–Ω–∏–µ HTML —Å —Ñ–æ—Ä–º—É–ª–∞–º–∏
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π –¥–ª—è –ø–µ—á–∞—Ç–∏

3. **–†–µ–Ω–¥–µ—Ä –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**
   - –ó–∞–≥—Ä—É–∑–∫–∞ HTML –≤ Playwright
   - –û–∂–∏–¥–∞–Ω–∏–µ networkidle
   - –†–µ–Ω–¥–µ—Ä —Ñ–æ—Ä–º—É–ª —á–µ—Ä–µ–∑ KaTeX
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–Ω–¥–µ—Ä–∞

4. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF:**
   - –í—ã–∑–æ–≤ page.pdf()
   - –§–æ—Ä–º–∞—Ç A4, printBackground: true
   - –í–æ–∑–≤—Ä–∞—Ç Buffer

### –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:

```typescript
// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF
const testData = {
  title: 'Matematika testi',
  className: '7-A',
  subjectName: 'Matematika',
  questions: [
    {
      number: 1,
      text: 'Hisoblang: $\\frac{2+3}{5}$',
      options: ['$1$', '$2$', '$3$', '$4$']
    }
  ]
};

const pdfBuffer = await PDFGeneratorService.generatePDF(testData);
```

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û

1. **Playwright —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞:**
   ```bash
   npx playwright install chromium
   ```

2. **–í Docker –Ω—É–∂–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```dockerfile
   RUN npx playwright install-deps chromium
   ```

3. **–ü–∞–º—è—Ç—å:**
   - –ë—Ä–∞—É–∑–µ—Ä –∑–∞–Ω–∏–º–∞–µ—Ç ~100-200MB RAM
   - –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏

4. **–ó–∞–∫—Ä—ã—Ç–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞:**
   - –ü—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤—ã–∑–≤–∞—Ç—å:
   ```typescript
   await PDFGeneratorService.closeBrowser();
   ```

---

## üîÆ –í–û–ó–ú–û–ñ–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å PDF –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤
   - Redis –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∫—ç—à–∞

2. **–û—á–µ—Ä–µ–¥—å:**
   - BullMQ –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

3. **Batch –≥–µ–Ω–µ—Ä–∞—Ü–∏—è:**
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
   - Zip –∞—Ä—Ö–∏–≤ —Å PDF —Ñ–∞–π–ª–∞–º–∏

4. **–í–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏:**
   - –õ–æ–≥–æ—Ç–∏–ø —à–∫–æ–ª—ã
   - QR-–∫–æ–¥ —Å—Ç—É–¥–µ–Ω—Ç–∞

---

**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–ê–≤—Ç–æ—Ä:** AI Assistant (Claude Sonnet 4.5)
